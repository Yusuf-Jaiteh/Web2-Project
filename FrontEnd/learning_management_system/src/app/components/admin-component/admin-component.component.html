<div class="content">
  <!-- Sidebar and Navbar -->
  <nav>
    <div class="dashboard-sidebar " [class.open]="isSidebar">
      <div class="sidebar-content">
        <ul class="menu-list">
          <li class="menu-item">COURSES
            <ul class="submenu">
              <li class="submenu-item">
                <button (click)="handleAction('courselist')" class="menu-button">ALL COURSES</button>
              </li>
              <li class="submenu-item">
                <button (click)="handleAction('addcourse')" class="menu-button">CREATE COURSE</button>
              </li>
            </ul>
          </li>
          
          <li class="menu-item">USER
            <ul class="submenu">
              <li class="submenu-item">
                <button (click)="handleAction('userlist')" class="menu-button">ALL USER</button>
              </li>
              <li class="submenu-item">
                <button (click)="handleAction('adduser')" class="menu-button">CREATE USER</button>
              </li>
            </ul>
          </li>

          <li>
            <div class="bg-danger p-3 m-3">
              <button class="btn btn-danger" (click)="logout()">LOGOUT</button>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <button class="icon" (click)="displaySidebar()">
      <i class="fa fa-bars"></i>
    </button>
  
    <div class="profile">
      <label for="name">{{ name }}</label>
      
      <div class="profile-icon">
        <i class="fa fa-user-circle"></i>
      </div>
    </div>
  </nav>

  <!-- Course List and User Management -->
  <div *ngIf="action === 'courselist'" [style.marginLeft]="isSidebar ? '320px' : '0'" >
    <app-course-list></app-course-list>
  </div>

  <!-- Available Users Table -->
  <div *ngIf="action === 'userlist'" class="min-vh-100" [style.marginLeft]="isSidebar ? '320px' : '0'" >
    <div class="text-center">
      <h1>Available Users</h1>
    </div>

    <div class="table-responsive">
      <table class="table table-striped table-bordered table-hover">
        <thead class="table-success">
          <tr>
            <th class="text-center font-weight-bold">Number</th>
            <th class="text-center font-weight-bold">First Name</th>
            <th class="text-center font-weight-bold">Last Name</th>
            <th class="text-center font-weight-bold">Username</th>
            <th class="text-center font-weight-bold">Role</th>
          </tr>
        </thead>
  
        <tbody>
          <tr *ngFor="let obj of users; let i = index">
            <td class="text-center font-weight-bold">{{ i + 1 }}</td>
            <td class="text-center font-weight-bold">{{ obj.user.firstName }}</td>
            <td class="text-center font-weight-bold">{{ obj.user.lastName }}</td>
            <td class="text-center font-weight-bold">{{ obj.user.username }}</td>
            <td class="text-center font-weight-bold">{{ obj.user.role }}</td>
            <td class="text-center font-weight-bold">
              <button class="btn btn-warning" (click)="handleEditUser(obj.user)">Edit</button>
              <button class="btn btn-danger" (click)="handleDeleteUser(obj.user._id)">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
  </div>

  <!-- Add New Course Form -->
  <div *ngIf="action === 'addcourse'" [style.marginLeft]="isSidebar ? '320px' : '0'">
    <div class="course-form-card">
      <div class="card-header" *ngIf="mode === 'add'"><h3> New Course</h3></div>
      <div class="card-header" *ngIf="mode === 'update'"><h3> Update Course</h3></div>
      <form action="#" method="POST" class="course-form" [formGroup]="addCourseForm" (ngSubmit)="handleCourseAdd()">
        <div class="form-group">
          <label for="title" class="form-label">Title</label>
          <input class="form-control" type="text" name="title" id="title" formControlName="courseTitle" required />
        </div>

        <div class="form-group">
          <label for="author" class="form-label">Description</label>
          <textarea formControlName="description" class="form-control"></textarea>
        </div>

        <div class="mb-5">
          <label for="user" class="form-label">Instructor:</label>
          <select class="form-control" id="user" name="user" formControlName="instructor">
            <option value="">--Select Instructor--</option>
            <option *ngFor="let obj of(users || []) | filterInstructor" [ngValue]="obj.user">
              {{ obj.user.firstName }} {{ obj.user.lastName }}
            </option>
          </select>
        </div>

        <div class="d-grid gap-2">
          <div class="text-center">
            <button type="submit" class="btn btn-primary submit" *ngIf="mode === 'add'">
              Add Course
            </button>
          </div>
          <div>
            <button type="submit" class="btn btn-primary submit" *ngIf="mode === 'update'">
              Update Course
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Add New User Form -->
  <div *ngIf="action === 'adduser'" [style.marginLeft]="isSidebar ? '320px' : '0'" >
    <div  class="assignment-form-card">
      <div class="card-header" *ngIf="mode === 'add'"><h3>New User</h3></div>
      <div class="card-header" *ngIf="mode === 'update'"><h3>Update User</h3></div>
      <form action="#" method="POST" class="assignment-form" [formGroup]="addUserForm" (ngSubmit)="handleUserAdd()">
        <div class="form-group">
          <label for="firstName" class="form-label">First Name</label>
          <input class="form-control" type="text" id="firstName" name="firstName" formControlName="firstName" required />
        </div>
        <div class="form-group">
          <label for="lastName" class="form-label">Last Name</label>
          <input class="form-control" type="text" id="lastName" name="lastName" formControlName="lastName" required />
        </div>
        <div class="form-group">
          <label for="username" class="form-label">Username</label>
          <input class="form-control" type="text" id="username" name="username" formControlName="username" required />
        </div>
        <div class="form-group" *ngIf="mode === 'add'">
          <label for="password" class="form-label">Password</label>
          <input class="form-control" type="password" id="password" name="password" formControlName="password" required />
        </div>
        <div class="form-group">
          <label for="role" class="form-label">Role</label>
          <select class="form-control" id="role" name="role" formControlName="role" required>
            <!-- <option value="admin">Admin</option> -->
            <option value="">--Select Role--</option>
            <option value="Instructor">Instructor</option>
            <option value="Student">Student</option>
          </select>
        </div>
        <div class="d-grid gap-2">
          <div class="text-center">
            <button type="submit" class="btn btn-primary submit" *ngIf="mode === 'add'">Add User</button>
          </div>
          <div class="text-center">
            <button type="submit" class="btn btn-primary submit" *ngIf="mode === 'update'">Update User</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
